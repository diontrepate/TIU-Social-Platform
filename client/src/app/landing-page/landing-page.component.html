
<div class="topBar">

    <div class="imageContainer">
        <img src="assets/avatar.png" (click)="menu.toggle($event)" alt="Avatar" class="avatar">         
    </div>

    <div class="nameLabel">{{userInfo.firstName}}</div>

</div>

    <p-menu #menu [popup]="true" [model]="menuItems"></p-menu>
    <p-menu #post [popup]="true" [model]="postItems"></p-menu>
    <p-menu #comment [popup]="true" [model]="commentItems"></p-menu>

<div class="sidePanel">

    <p-autoComplete [(ngModel)]="chosenGroup" [suggestions]="filteredGroups" (completeMethod)="filterGroups($event)" [size]="30"
        [minLength]="1" placeholder="Type in the group you'd like to join" [dropdown]="true">
        <ng-template let-brand pTemplate="item">
            <div class="ui-helper-clearfix" style="border-bottom:1px solid #D5D5D5">
                <div style="font-size:12px; margin-top: 6px">{{brand}}</div>
            </div>
        </ng-template>
    </p-autoComplete>

    <button style=" margin: 10px 5px auto; top: 10px; width: 95%" pButton type="button" (click)="prepareGroupData()" label="Join Group" class="ui-button-rounded"></button>
    <button style=" margin: 10px 5px auto; top: 10px; width: 95%" pButton type="button" (click)="showDialog();" label="Create Group" class="ui-button-rounded"></button>
        <div *ngFor="let groups of this.userGroups; let i = index"> 
            <br>
        <div *ngIf="!mobile">
            <p-card header='' [style]="{width: '95%', height:'95px', margin:' 10px auto'}" (click)="this.isHome = false; this.getNewsForGroup(groups.newsInterests[0]); this.passCurrentGroup(groups)" styleClass="ui-card-shadow">
                <p-header style="margin: 40%">
                
                </p-header>
        <div style="margin: 10%"> {{groups?.name}} </div>

                    <p-footer></p-footer>
             </p-card>
        </div>

            <div *ngIf="mobile">
                
                <p-card header=""  [style]="{width: '95%', height:'95px', margin:' 10px auto'}" (click)="this.isHome = false; this.getNewsForGroup(groups.newsInterests); this.passCurrentGroup(groups)" styleClass="ui-card-shadow">
                    <p-header style="margin: 40%">
                            {{groups?.name}}
        
                    </p-header>

                 <div style="margin: 10%"> {{groups?.name}} </div>

                    <p-footer>
                
                    </p-footer>
                </p-card>
            </div>

                <br>
                </div>
</div>

<p-dialog header="Title" [(visible)]="display" [draggable]="false" [modal]="true" [style]="{width: '50%', height: '280px'}" >
    Please insert the name of the group
        <br>
        <div [formGroup]="addGroupForm">
        <input style="width:95%;" formControlName="name" type="text"  placeholder="Name" required pInputText /> 
        <br>
        <br>
        <br>
        <div style="text-align: center">Please insert the News Interest for this group</div>
        <input style="width:95%;" formControlName="newsInterest" type="text"  placeholder="News Interest" required pInputText /> 
        <br>
        <button style="width: 70%; margin-left: 15%; margin-top: 10%" pButton (click)="addGroup()" type="button" label="Submit"  class="ui-button-rounded"></button>

    </div>

</p-dialog>

<p-confirmDialog [style]="{width: '50vw'}"></p-confirmDialog>

 <!------------------------------------------Section For Feed When User Lands on Home-------------------------------------------------------------------------->

<div *ngIf="isHome">

        <div [formGroup]="postForm" class="addPostContainer">
            <textarea class="addPost" formControlName="generalPost"  placeholder="Type your thoughts here..." pInputTextarea></textarea>
            <button  pButton type="button" label="Post" (click)="this.submitPost(true)" class="ui-button-rounded"></button>
        </div>
<div class="carousel">
        <p-carousel headerText="NEWS" [autoplayInterval]="10000" [value]="items">
                <ng-template let-item pTemplate="item">
                    <div class="ui-grid ui-grid-responsive" style="background-color:rgba(253, 222, 222, 0.233)">
        
                        <div class="ui-grid-row">
                            <div class="ui-grid-col-12">
                                <div style="width:50%; margin:auto; height: 100%;"> <a href={{item.link}} target="_blank"> <img class="crop" src="{{item.linkToImage}}" /></a> </div> 
                            </div>
                        </div> 
        
                            <div style="width:95%;text-align: center; height: 70px; position: relative; top: 10%"><a href={{item.link}} target="_blank"> <p style="color:rgb(22, 22, 22)">{{item.title}}</p></a></div>
                       
                    </div>
                </ng-template>
              </p-carousel>
    </div>
 

    <div class="mainBody">
        <div *ngFor="let posts of allPosts; let i = index" > 
            <div class="postFeedWrapper">
            <p-card  [style]="{width: '64%', height:'200px', marginLeft:'12.8%', marginTop:'5%'}" styleClass="ui-card-shadow">
                <p-header>
                    <div class="profilePic"> <img src="assets/avatar.png" alt="Avatar" class="avatar" ></div>
                    <div class="nameAndTime">{{posts.firstName}}<br>{{this.reformattedDate(posts.dateCreated)}}</div>
                    <div *ngIf="posts.firstName == userInfo.firstName">
                    <div class="ellipse"><i class="pi pi-ellipsis-h" (click)=" this.setPostId(posts.postId); post.toggle($event);" style="font-size: 3em"></i>
                    </div>
                    </div>
                    <div *ngIf="posts.firstName !== userInfo.firstName">
                    <div class="ellipse">
                    </div>
                    </div>
                    <div class="postBody">{{posts.bodyText}}</div>
                    <div class="like">  
                            
                        <i class="pi pi-thumbs-up" style="font-size: 2.2em; color: #282828"></i>
                        <p style="margin-left:10px; margin-top:2px; font-size: 20px">{{posts.postIdList.length}}</p>

                    </div>
                   
                 

                </p-header>
            </p-card>
        
       <div class="commentWrapper">

            <div *ngFor="let comments of posts.comments; let i = index">
                <div *ngIf="!mobile">
                    <p-card  [style]="{width: '65%', height:'150px', marginLeft:'12.9%', backgroundColor:'#F0F0F0'}" >
                           
                            <p-header>
                                    <div class="profilePic"> <img src="assets/avatar.png" alt="Avatar" class="avatar" ></div>
                                    <div class="nameAndTime">{{comments?.firstName}}<br>{{this.reformattedDate(comments.dateCreated)}}</div>
                                    <div *ngIf="posts.firstName == userInfo.firstName">
                                    <div class="ellipse"><i class="pi pi-ellipsis-h" (click)=" this.setCommentId(comments.commentId); comment.toggle($event);" style="font-size: 3em"></i>
                                    </div>
                                    </div>
                                    <div *ngIf="comments.firstName !== userInfo.firstName">
                                    <div class="ellipse">
                                    </div>
                                    </div>
                                    <div class="postBody">{{comments.bodyText}}</div>
                            </p-header>
                        </p-card>
                </div>

                <div *ngIf="mobile">
                    <p-card  [style]="{width: '65%', height:'80px', marginLeft:'12.9%', backgroundColor:'#F0F0F0', 'boxShadow':'none'}" >
                  
                            <p-header>
                                    <div class="profilePic"> <img src="assets/avatar.png" alt="Avatar" class="avatar" ></div>
                                    <div class="nameAndTime">{{comments?.firstName}}<br>{{this.reformattedDate(comments.dateCreated)}}</div>
                                    <div *ngIf="posts.firstName == userInfo.firstName">
                                    <div class="ellipse"><i class="pi pi-ellipsis-h" (click)=" this.setCommentId(comments.commentId); post.toggle($event);" style="font-size: 3em"></i>
                                    </div>
                                    </div>
                                    <div *ngIf="comments.firstName !== userInfo.firstName">
                                    <div class="ellipse">
                                    </div>
                                    </div>
                                    <div class="postBody">{{comments.bodyText}}</div>
                            </p-header>
                        </p-card>
                </div>


            </div>
        </div>

            <div [formGroup]="postForm">
                    <div class="textBox"><textarea  autoResize="true" class="addComment" formControlName="comment"  placeholder="Comment" pInputTextarea></textarea>
                    </div>
                    </div>
                    <div class="comment"> <button style="width: 100%; height: 100%" pButton type="button" label="comment" class="ui-button-rounded"></button>
                    </div>
        </div>

          
            
        </div>    
    </div>

</div>

<!------------------------------------------Section For Feed When Group Is Selected-------------------------------------------------------------------------->
<p-messages [value]="this.msgs"></p-messages>

<div *ngIf="isGroup">

        <div class="navToLanding">
                <button  pButton type="button" label="Home" (click)="this.isGroup = false; this.isHome = true" class="ui-button-rounded"></button>
                <button  pButton type="button" label="Leave" (click)="this.leaveGroup()" class="ui-button-rounded ui-button-danger"></button>

            </div>

        <div class="addPostContainer" [formGroup]="postForm">
            <textarea class="addPost" formControlName="post" placeholder="Type your thoughts here..." pInputTextarea></textarea>
            <button pButton type="button" label="Post" (click)="this.submitPost()" class="ui-button-rounded"></button>
        </div>
    <div class="carousel">
            <p-carousel headerText="NEWS" [autoplayInterval]="10000" [value]="groupItems">
                    <ng-template let-item pTemplate="item">
                        <div class="ui-grid ui-grid-responsive" style="background-color:rgba(253, 222, 222, 0.233)">
            
                            <div class="ui-grid-row">
                                <div class="ui-grid-col-12">
                                    <div style="width:50%; margin:auto; height: 100%;"> <a href={{item.link}} target="_blank"> <img class="crop" src="{{item.linkToImage}}" /></a> </div> 
                                </div>
                            </div> 
            
                                <div style="width:95%;text-align: center; height: 70px; position: relative; top: 10%"><a href={{item.link}} target="_blank"> <p style="color:rgb(22, 22, 22)">{{item.title}}</p></a></div>
                           
                        </div>
                    </ng-template>
                  </p-carousel>
        </div>

        <div class="mainBody">

            <div *ngFor="let posts of groupPosts; let i = index"> 
    
                    <p-card [style]="{width: '64%', height:'200px', marginLeft:'12.8%', marginTop:'5%'}" styleClass="ui-card-shadow">
                            <p-header>
                                <div class="profilePic"> <img src="assets/avatar.png" alt="Avatar" class="avatar" ></div>
                                <div class="nameAndTime">{{posts?.firstName}}<br>{{this.reformattedDate(posts.dateCreated)}}</div>
                                <div *ngIf="posts.firstName == userInfo.firstName">
                                        <div class="ellipse"><i class="pi pi-ellipsis-h" (click)=" this.setPostId(posts.postId); post.toggle($event);" style="font-size: 3em"></i>
                                        </div>
                                        </div>
                                        <div *ngIf="posts.firstName !== userInfo.firstName">
                                        <div class="ellipse">
                                        </div>
                                        </div>
                                <div class="postBody">{{posts.bodyText}}</div>
                                <div class="like">  
                                        
                                    <i class="pi pi-thumbs-up" style="font-size: 2.2em; color: #282828"></i>
                                    <p style="margin-left:10px; margin-top:2px; font-size: 20px">{{posts.postIdList.length}}</p>
            
                                </div>
                            
                            </p-header>
                         
                       
                        </p-card>
                        <div class="commentWrapper">

                        <div *ngFor="let comments of posts.comments; let i = index">

                            <div *ngIf="!mobile">
                                     
                            <p-header>
                                    <div class="profilePic"> <img src="assets/avatar.png" alt="Avatar" class="avatar" ></div>
                                    <div class="nameAndTime">{{comments?.firstName}}<br>{{this.reformattedDate(comments.dateCreated)}}</div>
                                    <div *ngIf="posts.firstName == userInfo.firstName">
                                    <div class="ellipse"><i class="pi pi-ellipsis-h" (click)=" this.setCommentId(comments.commentId); post.toggle($event);" style="font-size: 3em"></i>
                                    </div>
                                    </div>
                                    <div *ngIf="comments.firstName !== userInfo.firstName">
                                    <div class="ellipse">
                                    </div>
                                    </div>
                                    <div class="postBody">{{comments.bodyText}}</div>
                            </p-header>
                            </div>
            
                            <div *ngIf="mobile">
                                <p-card  [style]="{width: '65%', height:'80px', marginLeft:'12.9%', backgroundColor:'#F0F0F0'}" >
                                           
                            <p-header>
                                    <div class="profilePic"> <img src="assets/avatar.png" alt="Avatar" class="avatar" ></div>
                                    <div class="nameAndTime">{{comments?.firstName}}<br>{{this.reformattedDate(comments.dateCreated)}}</div>
                                    <div *ngIf="posts.firstName == userInfo.firstName">
                                    <div class="ellipse"><i class="pi pi-ellipsis-h" (click)=" this.setCommentId(comments.commentId); post.toggle($event);" style="font-size: 3em"></i>
                                    </div>
                                    </div>
                                    <div *ngIf="comments.firstName !== userInfo.firstName">
                                    <div class="ellipse">
                                    </div>
                                    </div>
                                    <div class="postBody">{{comments.bodyText}}</div>
                            </p-header>
                                    </p-card>
            
                        </div>
                    </div>
                </div>    

                        <div [formGroup]="postForm">

                                <div class="textBox"><textarea  autoResize="true" class="addComment" formControlName="comment"  placeholder="Comment" pInputTextarea></textarea>
                                </div>
                                </div>
                                <div class="comment"> <button style="width: 100%; height: 100%" pButton type="button" label="comment" class="ui-button-rounded"></button>
                                </div>
                                
                        </div>
</div>
